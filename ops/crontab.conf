# ===========================================
# CRONTAB - Tâches automatisées
# ===========================================
# 
# Installation :
#   1. sudo crontab -e
#   2. Coller le contenu de ce fichier
#
# Ou directement :
#   sudo crontab /chemin/vers/crontab.conf
#
# ===========================================

# Variables d'environnement
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=""

# ===========================================
# HEALTH CHECK - Toutes les 5 minutes
# ===========================================
*/5 * * * * /home/deploy/apps/mon-projet/ops/scripts/healthcheck.sh >> /var/log/healthcheck.log 2>&1

# ===========================================
# BACKUP - Tous les jours à 3h du matin
# ===========================================
0 3 * * * /home/deploy/apps/mon-projet/ops/scripts/backup.sh >> /var/log/backup.log 2>&1

# ===========================================
# MAINTENANCE - Tous les dimanches à 4h du matin
# ===========================================
0 4 * * 0 /home/deploy/apps/mon-projet/ops/scripts/maintenance.sh >> /var/log/maintenance.log 2>&1

# ===========================================
# RENOUVELLEMENT SSL - Vérification quotidienne
# (Traefik le fait automatiquement, c'est juste une vérification)
# ===========================================
0 12 * * * docker exec traefik traefik healthcheck >> /var/log/traefik-health.log 2>&1

# ===========================================
# NETTOYAGE LOGS - Tous les jours à 5h
# ===========================================
0 5 * * * find /var/log -name "*.log" -size +100M -exec truncate -s 0 {} \;

# ===========================================
# MISE À JOUR SÉCURITÉ - Tous les jours à 2h
# (Géré par unattended-upgrades, mais on peut forcer)
# ===========================================
# 0 2 * * * apt update && apt upgrade -y -o Dpkg::Options::="--force-confold"
